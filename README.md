# gin-template
## Описание

`gin-template` — это шаблон проекта на Go с использованием фреймворка [Gin](https://github.com/gin-gonic/gin) для быстрого старта разработки веб-приложений. Форк для exception:teapots

## Возможности

- Быстрый запуск сервера
- Организованная структура проекта
- Пример работы с маршрутами и middleware

## Установка

```bash
git clone https://github.com/exceptionteapots/gin-template.git
cd gin-template
go mod tidy
```

## Использование

Запустите сервер командой:

```bash
go run main.go
```
## Сборка и запуск в Docker

Соберите и запустите контейнер с помощью Docker:

```bash
docker build -t gin-template .
docker run -p 8080:8080 gin-template
```

## Использование с Docker Compose

```

Запустите приложение:

```bash
docker-compose up --build
```

## Как добавить новый модуль/эндпоинт

1. **Создайте модель**  
   В папке `internal/models/` создайте файл с описанием структур данных для новой сущности.

2. **Создайте репозиторий**  
   В `internal/repositories/` добавьте файл с реализацией интерфейса доступа к данным для новой сущности.

3. **Создайте домен**  
   В `internal/domains/` реализуйте бизнес-логику для новой сущности.

4. **Создайте контроллер**  
   В `internal/controllers/` добавьте HTTP-обработчики (контроллеры) для новых маршрутов.

5. **Добавьте маршруты**  
   В файле `internal/server/server.go` зарегистрируйте новые маршруты и свяжите их с обработчиками.

6. **Добавьте тесты**  
   Для каждого слоя (handler, service, repository) создайте соответствующие тесты.

7. **Обновите документацию**  
   При необходимости добавьте описание новых эндпоинтов в `docs/swagger.json`.

## Структура проекта

```
.
├── main.go                  # Точка входа в приложение, инициализация зависимостей и запуск сервера
├── go.mod                   # Модуль Go, список зависимостей
├── go.sum                   # Контрольные суммы зависимостей
├── Dockerfile               # Инструкция для сборки Docker-образа приложения
├── docker-compose.yml       # Конфигурация для запуска приложения и зависимостей (например, БД) в Docker
├── gin-template-example.yml # Пример конфигурационного файла приложения
├── README.md                # Документация по проекту
├── docs/
│   └── swagger.json         # Документация OpenAPI/Swagger для API
├── config/
│   └── config.go        # Загрузка и структура конфигурации приложения
├── controllers/
│   ├── hello.go         # HTTP-обработчики (контроллеры) для маршрутов
│   └── hello_test.go    # Тесты для обработчиков
├── logger/
│   └── logger.go        # Инициализация и настройка логгера (zap)
├── models/
│   ├── common.go        # Общие структуры данных, например, сообщения и ошибки
│   └── hello.go         # Структуры данных для модуля hello-сущности 
├── repositories/
│   ├── repository.go            # Основной репозиторий, инициализация работы с БД
│   ├── repository_hello.go      # Реализация репозитория для hello-сущности
│   ├── repository_hello_test.go # Тесты для hello-репозитория
│   └── repository_test.go       # Тесты для основного репозитория
├── server/
│   └── server.go        # Инициализация и запуск HTTP-сервера, маршрутизация
├── redis/
│   └── redis.go        # Функция для инициализации клиента Redis
└── domains/
   └── hello.go         # Бизнес-логика (сервисы) для hello-сущности
```

- `main.go` Главный файл, где собираются все зависимости, запускается сервер, реализуется graceful shutdown.
- `config/` — Работа с конфигурацией: чтение из файлов, структура конфигов.
- `logger/` — Настройка логирования через zap.
- `models/` — Описывает структуры данных, которые используются для передачи данных между слоями (например, сообщения, ошибки) и отправки ответов.
- `repositories/` — Слой доступа к данным (работа с БД), реализует паттерн "репозиторий". Содержит интерфейсы и реализации для работы с конкретными сущностями.
- `domains/` — Бизнес-логика приложения, сервисы, которые используют репозитории.
- `controllers/` — HTTP-обработчики (контроллеры), принимают запросы, вызывают сервисы, возвращают ответы.
- `server/` — Инициализация и запуск HTTP-сервера, настройка маршрутов и middleware.
- `redis/` — Инициализация клиента Redis.
- `docs/` — Документация API (Swagger/OpenAPI).
- `Dockerfile`, `docker-compose.yml` — Для контейнеризации и запуска приложения с зависимостями.
- `gin-template-example.yml` — Пример конфигурационного файла для приложения.

# Архитектурные практики

- **Dependency Injection**: Все зависимости (репозитории, логгеры и т.д.) передаются через конструкторы, что облегчает тестирование и расширяемость.
- **Разделение DTO и Entity**: Для передачи данных между слоями используются отдельные структуры (entity для внутренней логики, models для API-ответов). Преобразование происходит на границе слоя (например, в контроллере).
- **Graceful shutdown**: Сервер корректно завершает работу по сигналу завершения.

Эти практики позволяют использовать шаблон как надёжную основу для микросервисных приложений на Go.

## TODO

- [ ] Добавить кастомные ошибки для `service`.
- [x] Добавить пример middleware (Correlation-ID).
- [ ] Добавление GitHub Actions.
- [ ] Добавление OpenTelemetry.
    - [ ] Трейсы.
    - [ ] Метрики.
    - [ ] Логи.
- [ ] Добавление шаблонов для GitHub.
- [ ] Добавление примера тестов 
    - [ ] Для модуля `service`.
    - [ ] Для модуля `server`.
    - [ ] Для модуля `handler`.
    - [ ] Для модуля `config`.
- [ ] Добавление миграций используя goose.


## Тестирование

Для тестирования используйте команду:

```bash
go test ./...
```

## Ответственный

В случае вопросов/комментариев/предложений по использованию/обновлению шаблона обращаться к [Irurnnen](mailto://i19v199a56n78@gmail.com)

## Требования

- Go 1.24 или выше

## Лицензия

MIT
